<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuraci√≥n Central y Sincronizaci√≥n ‚Äì CondoConnect AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: #f1f5f9; /* slate-100 */
      font-family: 'Inter', sans-serif;
    }
    .glass-effect {
      background: linear-gradient(135deg, rgba(15,23,42,0.9), rgba(30,41,59,0.8));
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(59,130,246,0.3); /* blue-500/30 */
      box-shadow: 0 8px 32px rgba(59,130,246,0.1);
      border-radius: 1rem;
    }
    .metallic-surface {
      background: linear-gradient(145deg, #0f172a, #1e293b 25%, #334155 50%, #1e293b 75%, #0f172a);
      border: 1px solid rgba(59,130,246,0.5);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
    }
    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #475569; /* slate-600 */
        transition: .4s;
        border-radius: 34px;
    }
    .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    input:checked + .slider {
        background-color: #3b82f6; /* blue-500 */
    }
    input:checked + .slider:before {
        transform: translateX(26px);
    }
  </style>
</head>
<body class="p-4 md:p-8">

  <div class="max-w-7xl mx-auto space-y-8">
    <header class="flex flex-col md:flex-row justify-between items-start md:items-center glass-effect p-6 mb-8">
      <div>
        <h1 class="text-3xl font-extrabold text-white mb-1 flex items-center">
          <i class="fas fa-tools mr-3 text-yellow-400"></i>
          Configuraci√≥n Central y Sincronizaci√≥n Web
        </h1>
        <p class="text-blue-300">Condominio Altavista ‚Ä¢ Portal para modificar y sincronizar la App</p>
      </div>
      <a href="panel-propiedad.html" class="mt-4 md:mt-0 px-4 py-2 metallic-surface rounded-lg text-sm hover:bg-gray-700 transition">
        <i class="fas fa-arrow-left mr-2"></i> Volver al Panel
      </a>
    </header>

    <!-- Estado de Sincronizaci√≥n y Modulos -->
    <div class="glass-effect p-6">
      <h2 class="text-xl font-bold text-blue-200 mb-4">üß© Gesti√≥n de M√≥dulos y Sincronizaci√≥n</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Tarjeta de Sincronizaci√≥n -->
        <div class="p-4 bg-green-900/10 border border-green-700 rounded-lg">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold text-green-400"><i class="fas fa-cloud-upload-alt mr-2"></i> Estado de Sincronizaci√≥n</h3>
            <span class="text-green-400 font-bold">ACTIVO</span>
          </div>
          <p class="text-sm text-blue-300 mt-2">Los cambios realizados en el portal web se aplican inmediatamente a la App del Administrador, la App del Residente y la App de Guardias (excepto el m√≥dulo de guardias, que es solo monitoreo).</p>
          <button onclick="simulateSync()" class="mt-3 px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-xs hover:bg-green-500/30 transition">
            Forzar Sincronizaci√≥n
          </button>
        </div>

        <!-- Opciones de M√≥dulos -->
        <div class="space-y-4">
          <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg">
            <div class="font-medium">
                <i class="fas fa-camera-retro mr-2 text-red-400"></i> Monitoreo CCTV con IA
            </div>
            <label class="toggle-switch">
                <input type="checkbox" checked id="toggleCCTV" onclick="updateSetting('CCTV', this.checked)">
                <span class="slider"></span>
            </label>
          </div>

          <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg">
            <div class="font-medium">
                <i class="fas fa-qrcode mr-2 text-purple-400"></i> Accesos QR y Facial
            </div>
            <label class="toggle-switch">
                <input type="checkbox" checked id="toggleAccesos" onclick="updateSetting('Accesos', this.checked)">
                <span class="slider"></span>
            </label>
          </div>

          <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg">
            <div class="font-medium">
                <i class="fas fa-file-signature mr-2 text-orange-400"></i> M√≥dulo de Contratos y Firma
            </div>
            <label class="toggle-switch">
                <input type="checkbox" checked id="toggleContratos" onclick="updateSetting('Contratos', this.checked)">
                <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Configuraci√≥n Biometr√≠a General -->
    <div class="glass-effect p-6">
        <h2 class="text-xl font-bold text-yellow-300 mb-4">üîê Pol√≠ticas de Biometr√≠a y Acceso</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="minAccuracy" class="block text-sm font-medium mb-1 text-blue-300">Precisi√≥n M√≠nima de Reconocimiento Facial (%)</label>
                <input type="number" id="minAccuracy" value="95" min="50" max="100" class="w-full p-3 bg-gray-800 rounded-lg border border-gray-700 focus:border-blue-500 transition text-white">
                <p class="text-xs text-gray-500 mt-1">Nivel de confianza requerido para un acceso exitoso. (Por defecto: 95%)</p>
            </div>
            <div>
                <label for="geofenceRadius" class="block text-sm font-medium mb-1 text-blue-300">Radio de Geolocalizaci√≥n (metros) para Biometr√≠a de Guardia</label>
                <input type="number" id="geofenceRadius" value="30" min="10" max="100" class="w-full p-3 bg-gray-800 rounded-lg border border-gray-700 focus:border-blue-500 transition text-white">
                <p class="text-xs text-gray-500 mt-1">Radio permitido alrededor del punto de servicio para un Check-in de guardia v√°lido.</p>
            </div>
            <div class="md:col-span-2">
                <button onclick="saveBiometricSettings()" class="w-full py-3 bg-yellow-600/50 hover:bg-yellow-600/70 text-white font-bold rounded-lg transition">
                    <i class="fas fa-save mr-2"></i> Guardar Pol√≠ticas Biom√©tricas
                </button>
            </div>
        </div>
    </div>
  </div>

  <script type="module">
    // Simulaci√≥n de funciones de sincronizaci√≥n/guardado
    function simulateSync() {
        alert('üåê Sincronizaci√≥n forzada iniciada. Los cambios en Firestore se propagan autom√°ticamente a las aplicaciones.');
    }

    function updateSetting(moduleName, isChecked) {
        const action = isChecked ? 'ACTIVADO' : 'DESACTIVADO';
        alert(`‚úÖ M√≥dulo ${moduleName} ${action} en la configuraci√≥n de la propiedad. Cambio sincronizado.`);
        // En producci√≥n, aqu√≠ ir√≠a el setDoc a Firestore para 'config/propertyConfig'
    }

    function saveBiometricSettings() {
        const accuracy = document.getElementById('minAccuracy').value;
        const radius = document.getElementById('geofenceRadius').value;
        alert(`‚úÖ Pol√≠ticas de Biometr√≠a guardadas y sincronizadas. Precisi√≥n: ${accuracy}%, Radio Geolocalizaci√≥n: ${radius}m.`);
        // En producci√≥n, aqu√≠ ir√≠a el setDoc a Firestore
    }


    // FIREBASE SETUP PARA SIMULACI√ìN DE DATOS
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // Variables globales de Firebase
    let db, auth;

    // Configuraci√≥n inicial de Firebase
    setLogLevel('debug'); // Habilitar logs
    try {
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        auth = getAuth(app);

        // Manejo de Autenticaci√≥n
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // Autenticado
            } else {
                try {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                      await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                      await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Error en autenticaci√≥n:", error);
                }
            }
        });
    } catch (e) {
        console.error("Error al inicializar Firebase:", e);
    }
  </script>
</body>
</html>

